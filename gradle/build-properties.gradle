import java.text.SimpleDateFormat

buildProperties.doLast {
    File buildInfo = it.outputs.files.files.find { it.name == 'grails.build.info' }
    if (!buildInfo) return

    Properties properties = new Properties()

    buildInfo.withInputStream { properties.load(it) }

    properties.setProperty('info.app.version', releaseVersion)

    def sdf = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ssX");
    sdf.setTimeZone(TimeZone.getTimeZone("GMT"));

    properties.setProperty('build.time', sdf.format(new Date()))
    properties.setProperty('build.java.version', System.getProperty('java.version'))

    buildInfo.withOutputStream { properties.store(it, null) }
}
